---
# IDS (Intrusion Detection System)

definition: >
  IDS (Intrusion Detection System) - это система обнаружения вторжений, которая мониторит сетевую активность
  с целью обнаружения аномального или вредоносного трафика. IDS может быть активным (с возможностью блокировать
  подозрительный трафик) или пассивным (только для мониторинга и предоставления уведомлений).

types:
  - NIDS (Network-based Intrusion Detection System): >
      Мониторит весь сетевой трафик на уровне сетевой инфраструктуры и анализирует его на предмет аномалий или
      атак.
  - HIDS (Host-based Intrusion Detection System): >
      Устанавливается на отдельные хосты и анализирует логи, системные события и другую активность на уровне хоста
      на предмет аномалий или атак.

example_software: "Snort, Suricata, OSSEC"

linux_commands:
  - tcpdump: >
      Команда для захвата и анализа сетевых пакетов в режиме реального времени. Она может использоваться для
      мониторинга трафика и определения подозрительной активности.
      Пример: tcpdump -i eth0 -w capture.pcap
  - nmap: >
      Утилита для сканирования сети и определения открытых портов, служб и уязвимостей на удаленных хостах.
      Пример: nmap -sS -p 1-65535 192.168.1.0/24
  - hping3: >
      Утилита для тестирования сетевой безопасности, позволяющая генерировать различные типы пакетов и анализировать
      ответы от удаленных хостов.
      Пример: hping3 -1 --flood -a 192.168.1.2 192.168.1.1
  - iptables: >
      Утилита для настройки и управления сетевыми правилами фильтрации и маршрутизации в Linux. Она может использоваться
      для блокировки подозрительного трафика или разрешения только определенного типа соединений.
      Пример: iptables -A INPUT -p tcp --dport 22 -j ACCEPT
  - fail2ban: >
      Утилита, которая анализирует лог-файлы и блокирует IP-адреса, совершающие слишком много неудачных попыток
      подключения, что может указывать на попытку вторжения.
      Пример: fail2ban-client status sshd
  - psad: >
      Утилита для анализа логов iptables и обнаружения подозрительной активности, такой как сканирование портов или
      атаки на службы. Она может отправлять уведомления администраторам и автоматически блокировать атакующие IP-адреса.
      Пример: psad -A

# Важно отметить, что для эффективного обнаружения вторжений и защиты сетевой инфраструктуры необходимо
# использовать комбинацию различных инструментов, таких как IDS, фильтры пакетов и аудит системы.

---

---
# Объяснение IPS (Intrusion Prevention System) в контексте сетевой инфраструктуры

IPS_definition: >
  IPS (Intrusion Prevention System) - это система предотвращения вторжений, которая активно анализирует и блокирует
  подозрительный сетевой трафик. IPS в реальном времени обнаруживает атаки и предотвращает их, основываясь на
  сигнатурах атак, аномалиях поведения или правилах безопасности.

# Примеры релевантных команд Linux для работы с IPS

linux_commands:
  - suricata: >
      Открытый сетевой IPS/IDS, который обнаруживает атаки на основе сигнатур, аномалий и протоколов. Он может быть
      настроен для блокировки атакующих IP-адресов или оповещения администраторов о подозрительной активности.
      Пример: suricata -c /etc/suricata/suricata.yaml -i eth0
  - snort: >
      Открытый сетевой IPS/IDS, который анализирует сетевой трафик и обнаруживает атаки на основе сигнатур и правил
      безопасности. Он также может быть настроен для блокировки атакующих IP-адресов или оповещения администраторов
      о подозрительной активности.
      Пример: snort -A console -q -u snort -g snort -c /etc/snort/snort.conf -i eth0

# Важно отметить, что для эффективного предотвращения вторжений и защиты сетевой инфраструктуры необходимо
# использовать комбинацию различных инструментов, таких как IPS, фильтры пакетов и аудит системы.

---

---
# Cheat Sheet для команды "snort" в Linux с примерами и их объяснением

snort_cheat_sheet:
  - command: snort -V
    explanation: Показывает версию программы Snort и информацию о компиляции.
  - command: snort -T -c /etc/snort/snort.conf
    explanation: >
      Проверяет конфигурацию Snort, указанную в файле /etc/snort/snort.conf, на наличие ошибок.
  - command: snort -A console -q -u snort -g snort -c /etc/snort/snort.conf -i eth0
    explanation: >
      Запускает Snort в режиме IDS (обнаружения вторжений) на интерфейсе eth0 с использованием конфигурационного файла
      /etc/snort/snort.conf и выводом результатов на консоль. Запускает Snort от имени пользователя 'snort' и группы
      'snort'.
  - command: snort -A fast -c /etc/snort/snort.conf -i eth0 -K ascii
    explanation: >
      Запускает Snort в режиме IDS на интерфейсе eth0 с использованием конфигурационного файла /etc/snort/snort.conf.
      Логирует алерты в формате "fast" (указывает только IP-адреса источника и назначения) и сохраняет логи в формате
      ASCII.
  - command: snort -A full -c /etc/snort/snort.conf -i eth0 -b -l /var/log/snort/
    explanation: >
      Запускает Snort в режиме IDS на интерфейсе eth0 с использованием конфигурационного файла /etc/snort/snort.conf.
      Логирует алерты в формате "full" (подробная информация об атаке) и сохраняет логи и захваченные пакеты в
      директории /var/log/snort/.
  - command: snort -c /etc/snort/snort.conf -i eth0 -r capture.pcap
    explanation: >
      Анализирует сохраненный файл захвата трафика (capture.pcap) с использованием конфигурационного файла
      /etc/snort/snort.conf и выводит обнаруженные атаки.

---

---
# Cheat Sheet для команды "barnyard2" в Linux с примерами и их объяснением

barnyard2_cheat_sheet:
  - command: barnyard2 -V
    explanation: Показывает версию программы Barnyard2.
  - command: barnyard2 -f snort.u2 -c /etc/snort/barnyard2.conf -d /var/log/snort/ -w /var/log/snort/barnyard2.waldo
    explanation: >
      Запускает Barnyard2 с использованием файла конфигурации /etc/snort/barnyard2.conf, указывая каталог для записи
      логов /var/log/snort/. Файл snort.u2 содержит двоичные логи, созданные Snort. Файл waldo используется для
      сохранения состояния обработки логов между перезапусками Barnyard2.
  - command: barnyard2 -c /etc/snort/barnyard2.conf -d /var/log/snort/ -w /var/log/snort/barnyard2.waldo -X
    explanation: >
      Запускает Barnyard2 с использованием файла конфигурации /etc/snort/barnyard2.conf и каталога для записи логов
      /var/log/snort/. Файл waldo используется для сохранения состояния обработки логов между перезапусками Barnyard2.
      Опция -X указывает Barnyard2 выводить подробную отладочную информацию.
  - command: barnyard2 -c /etc/snort/barnyard2.conf -d /var/log/snort/ -w /var/log/snort/barnyard2.waldo -R 10
    explanation: >
      Запускает Barnyard2 с использованием файла конфигурации /etc/snort/barnyard2.conf и каталога для записи логов
      /var/log/snort/. Файл waldo используется для сохранения состояния обработки логов между перезапусками Barnyard2.
      Опция -R указывает Barnyard2 повторно обрабатывать указанное количество записей событий (10 в данном случае) при
      запуске.
  - command: barnyard2 -c /etc/snort/barnyard2.conf -d /var/log/snort/ -w /var/log/snort/barnyard2.waldo -f snort.log -S
    explanation: >
      Запускает Barnyard2 с использованием файла конфигурации /etc/snort/barnyard2.conf и каталога для записи логов
      /var/log/snort/. Файл waldo используется для сохранения состояния обработки логов между перезапусками Barnyard2.
      
---


